<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>DRM Player - Auto Fullscreen with Controls</title>
  <link rel="icon" href="//alraqi-tv.com/DRM/shakaplayer/shaka.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="referrer" content="no-referrer">
  
  <!-- Shaka Player UI library and default CSS -->
  <script src="https://shaka-player-demo.appspot.com/dist/shaka-player.ui.js"></script>
  <link rel="stylesheet" type="text/css" href="https://shaka-player-demo.appspot.com/dist/controls.css">
  
  <!-- Chromecast SDK (optional) -->
  <script defer src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js"></script>

  <style>
    html, body {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden; /* لمنع ظهور أشرطة التمرير */
      display: flex;
      justify-content: center;
      align-items: center;
      background: #000;
    }
    .player-container {
      width: 100vw; /* عرض 100% من عرض النافذة */
      height: 100vh; /* ارتفاع 100% من ارتفاع النافذة */
      display: flex;
      justify-content: center;
      align-items: center;
      background: #000; /* خلفية سوداء للحاوية */
    }
    video {
      width: 100%;
      height: 100%;
      object-fit: contain; /* للحفاظ على نسبة العرض إلى الارتفاع */
      background-color: #000;
    }
    /* إخفاء أي عناصر غير ضرورية، ولكن لا تتدخل في عناصر تحكم Shaka Player */
    h1, input[type="text"], button, .footer {
      display: none !important;
    }

    /* أنماط الشاكا بلاير الأساسية (حافظ عليها كما هي) */
    .shaka-video-container .material-icons-round {
      color: #00abe2;
    }
    .shaka-seek-bar-container .shaka-seek-bar {
      background: linear-gradient(to right, #051937, #00205b, #00247e, #22229f, #510dbc);
    }
    .shaka-volume-bar-container .shaka-volume-bar {
      background: linear-gradient(to right, #051937, #00205b, #00247e, #22229f, #510dbc);
    }
    .shaka-spinner-path {
      stroke: #d62d20;
      stroke-linecap: round;
      animation: dash 1.5s ease-in-out infinite, color 6s ease-in-out infinite;
    }
    @keyframes dash {
      0% { stroke-dasharray: 1, 200; stroke-dashoffset: 0; }
      50% { stroke-dasharray: 89, 200; stroke-dashoffset: -35px; }
      100% { stroke-dasharray: 89, 200; stroke-dashoffset: -124px; }
    }
    @keyframes color {
      100%, 0% { stroke: #d62d20; }
      40% { stroke: #0057e7; }
      66% { stroke: #008744; }
      80%, 90% { stroke: #ffa700; }
    }
  </style>
</head>
<body>
  <div class="player-container">
    <video autoplay data-shaka-player poster="https://a.top4top.io/p_3529x2cg80.png" id="video"></video>
  </div>

  <script>
    document.addEventListener('shaka-ui-loaded', () => {
        initPlayer();
    });

    function initPlayer() {
      const video = document.getElementById('video');
      const ui = video['ui'];
      const controls = ui.getControls();
      const player = controls.getPlayer();

      // إعدادات واجهة التحكم: فقط play/pause, volume, fullscreen
      // تأكدنا هنا من تضمين 'fullscreen'
      const config = {
          'controlPanelElements': ['play_pause', 'spacer', 'volume', 'fullscreen'],
          'overflowMenuButtons': [],
          'statisticsList': [],
          'playbackRates': [1],
          'fastForwardRates': [],
          'rewindRates': []
      };
      ui.configure(config);

      window.player = player;
      window.ui = ui;

      player.addEventListener("error", onErrorEvent);
      controls.addEventListener("error", onErrorEvent);

      const manifestUri = "http://135.125.109.73:9000/beinsportglobal_.m3u8";
      const clearKeyInput = ":";
      const [keyId, key] = clearKeyInput.split(':');

      player.configure({
          drm: {
              clearKeys: {}
          }
      });
      
      if (keyId && key) {
          player.configure({
              drm: {
                  clearKeys: {
                      [keyId]: key
                  }
              }
          });
      }

      player.load(manifestUri).then(() => {
          console.log('The video has been loaded successfully!');
          // محاولة تفعيل وضع ملء الشاشة على عنصر "html" بعد التحميل الناجح
          // لا تزال قيود المتصفح قائمة، وقد تحتاج إلى تفاعل المستخدم.
          if (document.documentElement.requestFullscreen) {
              document.documentElement.requestFullscreen();
          } else if (document.documentElement.mozRequestFullScreen) { /* Firefox */
              document.documentElement.mozRequestFullScreen();
          } else if (document.documentElement.webkitRequestFullscreen) { /* Chrome, Safari and Opera */
              document.documentElement.webkitRequestFullscreen();
          } else if (document.documentElement.msRequestFullscreen) { /* IE/Edge */
              document.documentElement.msRequestFullscreen();
          }
      }).catch(onError);
    }

    function onErrorEvent(event) {
        onError(event.detail);
    }

    function onError(error) {
        console.error('Error code', error.code, 'object', error);
        alert('حدث خطأ أثناء تشغيل الفيديو: ' + error.code);
    }
  </script>
</body>
</html>
